/*
 * Copyright (C) 2008-2009 Motorola, Inc.
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
 * 02110-1301, USA.
 */
#ifndef FALSE
#define	FALSE	0
#define	TRUE	(!FALSE)
#endif

#define OFF	FALSE
#define	ON	(!OFF)

/* define device name for data transfers to IC */
#define KEY08_PF_NAME   "touchpad"

#define	KEY08_IOCTL_SET_TSB_HOLD_MIN		0
#define	KEY08_IOCTL_SET_TSB_HOLD_MAX		999
#define	KEY08_IOCTL_SET_TSB_VIB_MIN		0
#define	KEY08_IOCTL_SET_TSB_VIB_MAX		255

#define	KEY08_IOCTL_SET_IN_CALL				1
#define	KEY08_IOCTL_SET_NOT_IN_CALL		2
#define	KEY08_IOCTL_SET_BOOTLOADER_MODE	3
#define	KEY08_IOCTL_SET_NORMAL_MODE		4
#define	KEY08_IOCTL_GET_VERSION				5
#define	KEY08_IOCTL_WRITE_REGISTER			6
#define	KEY08_IOCTL_READ_REGISTER			7
#define	KEY08_IOCTL_DL_GET_STATUS			8
#define	KEY08_IOCTL_GET_MODE					9
#define	KEY08_IOCTL_END_FIRMWARE			10
#define	KEY08_IOCTL_DISPLAY_ONE_POINT		11
#define	KEY08_IOCTL_RESET						12
#define	KEY08_IOCTL_DEBUG						13
#define	KEY08_IOCTL_CALIBRATE				14
#define	KEY08_IOCTL_SETIRQ					15
#define	KEY08_IOCTL_DISABLE					16
#define	KEY08_IOCTL_ENABLE					17
#define	KEY08_IOCTL_READ_REGISTER16		18
#define	KEY08_IOCTL_GETIRQ					19
#define	KEY08_IOCTL_GET_CMD_STATUS			20
#define	KEY08_IOCTL_SET_CMD_STATUS			21
#define	KEY08_IOCTL_READ_4_REGS				22
#define	KEY08_IOCTL_SUSPEND					23
#define	KEY08_IOCTL_GET_POINT				24
#define	KEY08_IOCTL_SET_TSB_HOLD_MS		25
#define	KEY08_IOCTL_SET_TSB_VIB_MS			26
#define KEY08_IOCTL_SET_AREA            27
#define KEY08_IOCTL_SET_GX              28
#define KEY08_IOCTL_SET_GY              29

/* Zeppelin Specific IOCTLs start from 40 */
#define KEY08_IOCTL_SET_MESSAGE_PTR		40
#define KEY08_IOCTL_GET_TOUCH_SENS_DATA		41
#define KEY08_IOCTL_SAVE_CONFIG                 42
#define KEY08_IOCTL_CAL_STATUS                  43
#define KEY08_IOCTL_GET_BAD_CRC_COUNT           44

/* Bootloader statuses */
#define	KEY08_BL_WAITING_FOR_NOTHING	0
#define	KEY08_BL_WAITING_FOR_COMMAND	1
#define	KEY08_BL_WAITING_FOR_DATA		2
#define KEY08_BL_WAITING_FOR_CRC		3
#define KEY08_BL_GOT_BAD_CRC			4
#define KEY08_BL_WAITING_AFTER_BAD_CRC	5
#define KEY08_BL_WAITING_AFTER_GOOD_CRC	6
#define KEY08_BL_WAITING_FAILED			7

/* Status of driver. */
#define KEY08_MODE_UNKNOWN				0
#define KEY08_MODE_NORMAL				1
#define	KEY08_MODE_BOOTLOADER			2
#define	KEY08_MODE_OBP			3

/* Status of FIRMAWARE transfers */
#define	KEY08_FM_DOWNLOAD_SUCCESS		0x00
#define KEY08_FM_DOWNLOAD_STILL_ACTIVE	0x01
#define	KEY08_FM_DOWNLOAD_FAILED		0x02
#define	KEY08_FM_DOWNLOAD_NOT_STARTED	0x03

/* Status of CONFIGURATION transfers */
#define	KEY08_CFG_DOWNLOAD_SUCCESS		0x00
#define KEY08_CFG_DOWNLOAD_STILL_ACTIVE	0x10
#define	KEY08_CFG_DOWNLOAD_FAILED		0x20
#define	KEY08_CFG_DOWNLOAD_NOT_STARTED	0x30

#define NUMBER_OF_FINGERS		4

typedef struct	a_point
{
	int	X;
	int	Y;
	int	Z;
	int	W;
	int	finger;
} A_TOUCH_POINT, *A_TOUCH_POINT_PTR;

typedef struct	a_reg
{
	int	reg;
	int	value;
	int	vals[4];
} A_REG, *A_REG_PTR;

/* States for upgrading firmware. Bootloader (BL) states*/
#define BOOTLOADER_STATE_NOT_FOUND              0
#define BOOTLOADER_STATE_NOT_FOUND_SEARCH_ADDR1 1
#define BOOTLOADER_STATE_NOT_FOUND_SEARCH_ADDR2 2
#define BOOTLOADER_STATE_FOUND_CHECK_VER        3
#define BOOTLOADER_STATE_APPCRC_FAIL            4
#define BOOTLOADER_STATE_WAIT_UNLOCK_CMD        5
#define BOOTLOADER_STATE_READ_BEFORE_WAIT_FRAME 6
#define BOOTLOADER_STATE_WAIT_FRAME             7
#define BOOTLOADER_STATE_SENDING_FRAME_DATA     8
#define BOOTLOADER_STATE_WAIT_CRC_CHECK         9
#define BOOTLOADER_STATE_WAIT_CRC_RESULT        10
#define BOOTLOADER_STATE_WAIT_CHANGE_LINE       11

#define Q51001211009AK08_CHIP_ID_ADDR		0
#define Q51001211009AK08_CODE_VER_ADDR		1
#define Q51001211009AK08_BACKUP_ADDR		2
#define Q51001211009AK08_CALIBRATE_ADDR		3
#define Q51001211009AK08_RESET_ADDR		4
#define Q51001211009AK08_READ_ADDR_ADDR		5
#define Q51001211009AK08_HAPTICS_REQUEST_ADDR	6
#define Q51001211009AK08_FORCE_SNSR_VAL_ADDR	7
#define Q51001211009AK08_EEPROM_CHECKSUM_LSByte	8
#define Q51001211009AK08_EEPROM_CHECKSUM_MSByte	9
#define Q51001211009AK08_GEN_STATUS_ADDR	10
#define Q51001211009AK08_TOUCHSCREEN_STATUS	11
#define Q51001211009AK08_KEY_ENABLE_INPUT_ADDR	12
#define Q51001211009AK08_DEBUG_CNTRL_DELTA_ADDR	13
#define Q51001211009AK08_DEBUG_CNTRL_REF_ADDR	16
#define Q51001211009AK08_CHANNEL_CNTRL0_ADDR	32
#define Q51001211009AK08_CHANNEL_CNTRL1_ADDR	33
#define Q51001211009AK08_CHANNEL_CNTRL2_ADDR	34
#define Q51001211009AK08_CHANNEL_CNTRL3_ADDR	35
#define Q51001211009AK08_CHANNEL_CNTRL4_ADDR	36
#define Q51001211009AK08_CHANNEL_CNTRL5_ADDR	37
#define Q51001211009AK08_CHANNEL_CNTRL6_ADDR	38
#define Q51001211009AK08_CHANNEL_CNTRL7_ADDR	39
#define Q51001211009AK08_CHANNEL_CNTRL8_ADDR	40
#define Q51001211009AK08_CHANNEL_CNTRL9_ADDR	41
#define Q51001211009AK08_CHANNEL_CNTRL10_ADDR	42
#define Q51001211009AK08_CHANNEL_CNTRL11_ADDR	43
#define Q51001211009AK08_CHANNEL_CNTRL12_ADDR	44
#define Q51001211009AK08_CHANNEL_CNTRL13_ADDR	45
#define Q51001211009AK08_CHANNEL_CNTRL14_ADDR	46
#define Q51001211009AK08_CHANNEL_CNTRL15_ADDR	47
#define Q51001211009AK08_CHANNEL_CNTRL16_ADDR	48
#define Q51001211009AK08_CHANNEL_CNTRL17_ADDR	49
#define Q51001211009AK08_CHANNEL_CNTRL18_ADDR	50
#define Q51001211009AK08_CHANNEL_CNTRL19_ADDR	51
#define Q51001211009AK08_CHANNEL_CNTRL20_ADDR	52
#define Q51001211009AK08_CHANNEL_CNTRL21_ADDR	53
#define Q51001211009AK08_CHANNEL_CNTRL22_ADDR	54
#define Q51001211009AK08_CHANNEL_CNTRL23_ADDR	55
#define Q51001211009AK08_CHANNEL_CNTRL24_ADDR	56
#define Q51001211009AK08_CHANNEL_CNTRL25_ADDR	57
#define Q51001211009AK08_CHANNEL_CNTRL26_ADDR	58
#define Q51001211009AK08_CHANNEL_CNTRL27_ADDR	59
#define Q51001211009AK08_CHANNEL_CNTRL28_ADDR	60
#define Q51001211009AK08_CHANNEL_CNTRL29_ADDR	61
#define Q51001211009AK08_CHANNEL_CNTRL30_ADDR	32
#define Q51001211009AK08_CHANNEL_CNTRL31_ADDR	63
#define Q51001211009AK08_CHANNEL_CNTRL32_ADDR	64
#define Q51001211009AK08_CHANNEL_CNTRL33_ADDR	65
#define Q51001211009AK08_CHANNEL_CNTRL34_ADDR	66
#define Q51001211009AK08_CHANNEL_CNTRL35_ADDR	67
#define Q51001211009AK08_CHANNEL_CNTRL36_ADDR	68
#define Q51001211009AK08_CHANNEL_CNTRL37_ADDR	69
#define Q51001211009AK08_CHANNEL_CNTRL38_ADDR	70
#define Q51001211009AK08_CHANNEL_CNTRL39_ADDR	71
#define Q51001211009AK08_CHANNEL_CNTRL40_ADDR	72
#define Q51001211009AK08_CHANNEL_CNTRL41_ADDR	73
#define Q51001211009AK08_CHANNEL_CNTRL42_ADDR	74
#define Q51001211009AK08_CHANNEL_CNTRL43_ADDR	75
#define Q51001211009AK08_CHANNEL_CNTRL44_ADDR	76
#define Q51001211009AK08_CHANNEL_CNTRL45_ADDR	77
#define Q51001211009AK08_CHANNEL_CNTRL46_ADDR	78
#define Q51001211009AK08_CHANNEL_CNTRL47_ADDR	79
#define Q51001211009AK08_NEGATIVE_THRESH0_ADDR	80
#define Q51001211009AK08_NEGATIVE_THRESH1_ADDR	81
#define Q51001211009AK08_NEGATIVE_THRESH2_ADDR	82
#define Q51001211009AK08_NEGATIVE_THRESH3_ADDR	83
#define Q51001211009AK08_NEGATIVE_THRESH4_ADDR	84
#define Q51001211009AK08_NEGATIVE_THRESH5_ADDR	85
#define Q51001211009AK08_NEGATIVE_THRESH6_ADDR	86
#define Q51001211009AK08_NEGATIVE_THRESH7_ADDR	87
#define Q51001211009AK08_NEGATIVE_THRESH8_ADDR	88
#define Q51001211009AK08_NEGATIVE_THRESH9_ADDR	89
#define Q51001211009AK08_NEGATIVE_THRESH10_ADDR	90
#define Q51001211009AK08_NEGATIVE_THRESH11_ADDR	91
#define Q51001211009AK08_NEGATIVE_THRESH12_ADDR	92
#define Q51001211009AK08_NEGATIVE_THRESH13_ADDR	93
#define Q51001211009AK08_NEGATIVE_THRESH14_ADDR	94
#define Q51001211009AK08_NEGATIVE_THRESH15_ADDR	95
#define Q51001211009AK08_NEGATIVE_THRESH16_ADDR	96
#define Q51001211009AK08_NEGATIVE_THRESH17_ADDR	97
#define Q51001211009AK08_NEGATIVE_THRESH18_ADDR	98
#define Q51001211009AK08_NEGATIVE_THRESH19_ADDR	99
#define Q51001211009AK08_NEGATIVE_THRESH20_ADDR	100
#define Q51001211009AK08_NEGATIVE_THRESH21_ADDR	101
#define Q51001211009AK08_NEGATIVE_THRESH22_ADDR	102
#define Q51001211009AK08_NEGATIVE_THRESH23_ADDR	103
#define Q51001211009AK08_NEGATIVE_THRESH24_ADDR	104
#define Q51001211009AK08_NEGATIVE_THRESH25_ADDR	105
#define Q51001211009AK08_NEGATIVE_THRESH26_ADDR	106
#define Q51001211009AK08_NEGATIVE_THRESH27_ADDR	107
#define Q51001211009AK08_NEGATIVE_THRESH28_ADDR	108
#define Q51001211009AK08_NEGATIVE_THRESH29_ADDR	109
#define Q51001211009AK08_NEGATIVE_THRESH30_ADDR	110
#define Q51001211009AK08_NEGATIVE_THRESH31_ADDR	111
#define Q51001211009AK08_NEGATIVE_THRESH32_ADDR	112
#define Q51001211009AK08_NEGATIVE_THRESH33_ADDR	113
#define Q51001211009AK08_NEGATIVE_THRESH34_ADDR	114
#define Q51001211009AK08_NEGATIVE_THRESH35_ADDR	115
#define Q51001211009AK08_NEGATIVE_THRESH36_ADDR	116
#define Q51001211009AK08_NEGATIVE_THRESH37_ADDR	117
#define Q51001211009AK08_NEGATIVE_THRESH38_ADDR	118
#define Q51001211009AK08_NEGATIVE_THRESH39_ADDR	119
#define Q51001211009AK08_NEGATIVE_THRESH40_ADDR	120
#define Q51001211009AK08_NEGATIVE_THRESH41_ADDR	121
#define Q51001211009AK08_NEGATIVE_THRESH42_ADDR	122
#define Q51001211009AK08_NEGATIVE_THRESH43_ADDR	123
#define Q51001211009AK08_NEGATIVE_THRESH44_ADDR	124
#define Q51001211009AK08_NEGATIVE_THRESH45_ADDR	125
#define Q51001211009AK08_NEGATIVE_THRESH46_ADDR	126
#define Q51001211009AK08_NEGATIVE_THRESH47_ADDR	127
#define Q51001211009AK08_BURST_LENGTH_0_ADDR	128
#define Q51001211009AK08_BURST_LENGTH_1_ADDR	129
#define Q51001211009AK08_BURST_LENGTH_2_ADDR	130
#define Q51001211009AK08_BURST_LENGTH_3_ADDR	131
#define Q51001211009AK08_BURST_LENGTH_4_ADDR	132
#define Q51001211009AK08_BURST_LENGTH_5_ADDR	133
#define Q51001211009AK08_BURST_LENGTH_6_ADDR	134
#define Q51001211009AK08_BURST_LENGTH_7_ADDR	135
#define Q51001211009AK08_BURST_LENGTH_8_ADDR	136
#define Q51001211009AK08_BURST_LENGTH_9_ADDR	137
#define Q51001211009AK08_BURST_LENGTH_10_ADDR	138
#define Q51001211009AK08_BURST_LENGTH_11_ADDR	139
#define Q51001211009AK08_BURST_LENGTH_12_ADDR	140
#define Q51001211009AK08_BURST_LENGTH_13_ADDR	141
#define Q51001211009AK08_BURST_LENGTH_14_ADDR	142
#define Q51001211009AK08_BURST_LENGTH_15_ADDR	143
#define Q51001211009AK08_BURST_LENGTH_16_ADDR	144
#define Q51001211009AK08_BURST_LENGTH_17_ADDR	145
#define Q51001211009AK08_BURST_LENGTH_18_ADDR	146
#define Q51001211009AK08_BURST_LENGTH_19_ADDR	147
#define Q51001211009AK08_BURST_LENGTH_20_ADDR	148
#define Q51001211009AK08_BURST_LENGTH_21_ADDR	149
#define Q51001211009AK08_BURST_LENGTH_22_ADDR	150
#define Q51001211009AK08_BURST_LENGTH_23_ADDR	151
#define Q51001211009AK08_BURST_LENGTH_24_ADDR	152
#define Q51001211009AK08_BURST_LENGTH_25_ADDR	153
#define Q51001211009AK08_BURST_LENGTH_26_ADDR	154
#define Q51001211009AK08_BURST_LENGTH_27_ADDR	155
#define Q51001211009AK08_BURST_LENGTH_28_ADDR	156
#define Q51001211009AK08_BURST_LENGTH_29_ADDR	157
#define Q51001211009AK08_BURST_LENGTH_30_ADDR	158
#define Q51001211009AK08_BURST_LENGTH_31_ADDR	159
#define Q51001211009AK08_BURST_LENGTH_32_ADDR	160
#define Q51001211009AK08_BURST_LENGTH_33_ADDR	161
#define Q51001211009AK08_BURST_LENGTH_34_ADDR	162
#define Q51001211009AK08_BURST_LENGTH_35_ADDR	163
#define Q51001211009AK08_BURST_LENGTH_36_ADDR	164
#define Q51001211009AK08_BURST_LENGTH_37_ADDR	165
#define Q51001211009AK08_BURST_LENGTH_38_ADDR	166
#define Q51001211009AK08_BURST_LENGTH_39_ADDR	167
#define Q51001211009AK08_BURST_LENGTH_40_ADDR	168
#define Q51001211009AK08_BURST_LENGTH_41_ADDR	169
#define Q51001211009AK08_BURST_LENGTH_42_ADDR	170
#define Q51001211009AK08_BURST_LENGTH_43_ADDR	171
#define Q51001211009AK08_BURST_LENGTH_44_ADDR	172
#define Q51001211009AK08_BURST_LENGTH_45_ADDR	173
#define Q51001211009AK08_BURST_LENGTH_46_ADDR	174
#define Q51001211009AK08_BURST_LENGTH_47_ADDR	175
#define Q51001211009AK08_MIN_CYCLE_ADDR		176
#define Q51001211009AK08_TRIG_ENABLE_ADDR	183
#define Q51001211009AK08_TOUCHSCREEN_LNGTH_ADDR	184
#define Q51001211009AK08_SLIDER_SETUP_ADDR	189
#define Q51001211009AK08_TOUCHSCREEN_SETUP_ADDR	190
#define Q51001211009AK08_TOUCHSCREEN_HYST_ADDR	192
#define Q51001211009AK08_SLIDER_HYST_ADDR	197
#define Q51001211009AK08_LP_MODE_ADDR		198
#define Q51001211009AK08_AUX_DATA_1_ADDR	199
#define Q51001211009AK08_AUX_DATA_2_ADDR	200
#define Q51001211009AK08_AWAKE_TIMEOUT_ADDR	203
#define Q51001211009AK08_GUARD_CH_ENABLE_ADDR	204
#define Q51001211009AK08_AUX_SETUP_ADDR		205
#define Q51001211009AK08_DETECT_INT_ADDR	206
#define Q51001211009AK08_SHORT_DETECT_INT_ADDR	207
#define Q51001211009AK08_FORCE_SNSR_THRESH_ADDR	208
#define Q51001211009AK08_NDRIFT_SET_ADDR	209
#define Q51001211009AK08_PDRIFT_SET_ADDR	210
#define Q51001211009AK08_NEG_RECALIB_DELAY_ADDR	211
#define Q51001211009AK08_DRIFT_HOLD_TIME_ADDR	212
#define Q51001211009AK08_LINEAR_OFF_X_LSB_ADDR	222
#define Q51001211009AK08_LINEAR_OFF_X_MSB_ADDR	223
#define Q51001211009AK08_LINEAR_OFF_X_1_ADDR	224
#define Q51001211009AK08_LINEAR_OFF_X_2_ADDR	225
#define Q51001211009AK08_LINEAR_OFF_X_3_ADDR	226
#define Q51001211009AK08_LINEAR_OFF_X_4_ADDR	227
#define Q51001211009AK08_LINEAR_OFF_X_5_ADDR	228
#define Q51001211009AK08_LINEAR_OFF_X_6_ADDR	229
#define Q51001211009AK08_LINEAR_OFF_X_7_ADDR	230
#define Q51001211009AK08_LINEAR_OFF_X_8_ADDR	231
#define Q51001211009AK08_LINEAR_OFF_X_9_ADDR	232
#define Q51001211009AK08_LINEAR_OFF_X_10_ADDR	233
#define Q51001211009AK08_LINEAR_OFF_X_11_ADDR	234
#define Q51001211009AK08_LINEAR_OFF_X_12_ADDR	235
#define Q51001211009AK08_LINEAR_OFF_X_13_ADDR	236
#define Q51001211009AK08_LINEAR_OFF_X_14_ADDR	237
#define Q51001211009AK08_LINEAR_OFF_X_15_ADDR	238
#define Q51001211009AK08_LINEAR_OFF_X_16_ADDR	239
#define Q51001211009AK08_LINEAR_OFF_Y_LSB_ADDR	240
#define Q51001211009AK08_LINEAR_OFF_Y_MSB_ADDR	241
#define Q51001211009AK08_LINEAR_OFF_Y_1_ADDR	242
#define Q51001211009AK08_LINEAR_OFF_Y_2_ADDR	243
#define Q51001211009AK08_LINEAR_OFF_Y_3_ADDR	244
#define Q51001211009AK08_LINEAR_OFF_Y_4_ADDR	245
#define Q51001211009AK08_LINEAR_OFF_Y_5_ADDR	246
#define Q51001211009AK08_LINEAR_OFF_Y_6_ADDR	247
#define Q51001211009AK08_LINEAR_OFF_Y_7_ADDR	248
#define Q51001211009AK08_LINEAR_OFF_Y_8_ADDR	249
#define Q51001211009AK08_LINEAR_OFF_Y_9_ADDR	250
#define Q51001211009AK08_LINEAR_OFF_Y_10_ADDR	251
#define Q51001211009AK08_LINEAR_OFF_Y_11_ADDR	252
#define Q51001211009AK08_LINEAR_OFF_Y_12_ADDR	253
#define Q51001211009AK08_LINEAR_OFF_Y_13_ADDR	254
#define Q51001211009AK08_LINEAR_OFF_Y_14_ADDR	255
#define Q51001211009AK08_LINEAR_OFF_Y_15_ADDR	256
#define Q51001211009AK08_LINEAR_OFF_Y_16_ADDR	257
#define Q51001211009AK08_OMEGA_DATA_ADDR	258
#define Q51001211009AK08_DBG_1_DELTA_LSB_ADDR	512
#define Q51001211009AK08_DBG_1_DELTA_MSB_ADDR	513
#define Q51001211009AK08_DBG_2_DELTA_LSB_ADDR	514
#define Q51001211009AK08_DBG_2_DELTA_MSB_ADDR	515
#define Q51001211009AK08_DBG_3_DELTA_LSB_ADDR	516
#define Q51001211009AK08_DBG_3_DELTA_MSB_ADDR	517
#define Q51001211009AK08_DBG_4_DELTA_LSB_ADDR	518
#define Q51001211009AK08_DBG_4_DELTA_MSB_ADDR	519
#define Q51001211009AK08_DBG_5_DELTA_LSB_ADDR	520
#define Q51001211009AK08_DBG_5_DELTA_MSB_ADDR	521
#define Q51001211009AK08_DBG_6_DELTA_LSB_ADDR	522
#define Q51001211009AK08_DBG_6_DELTA_MSB_ADDR	523
#define Q51001211009AK08_DBG_7_DELTA_LSB_ADDR	524
#define Q51001211009AK08_DBG_7_DELTA_MSB_ADDR	525
#define Q51001211009AK08_DBG_8_DELTA_LSB_ADDR	526
#define Q51001211009AK08_DBG_8_DELTA_MSB_ADDR	527
#define Q51001211009AK08_DBG_9_DELTA_LSB_ADDR	528
#define Q51001211009AK08_DBG_9_DELTA_MSB_ADDR	529
#define Q51001211009AK08_DBG_10_DELTA_LSB_ADDR	520
#define Q51001211009AK08_DBG_10_DELTA_MSB_ADDR	531
#define Q51001211009AK08_DBG_11_DELTA_LSB_ADDR	532
#define Q51001211009AK08_DBG_11_DELTA_MSB_ADDR	533
#define Q51001211009AK08_DBG_12_DELTA_LSB_ADDR	534
#define Q51001211009AK08_DBG_12_DELTA_MSB_ADDR	535
#define Q51001211009AK08_DBG_13_DELTA_LSB_ADDR	536
#define Q51001211009AK08_DBG_13_DELTA_MSB_ADDR	537
#define Q51001211009AK08_DBG_14_DELTA_LSB_ADDR	538
#define Q51001211009AK08_DBG_14_DELTA_MSB_ADDR	539
#define Q51001211009AK08_DBG_15_DELTA_LSB_ADDR	540
#define Q51001211009AK08_DBG_15_DELTA_MSB_ADDR	541
#define Q51001211009AK08_DBG_16_DELTA_LSB_ADDR	542
#define Q51001211009AK08_DBG_16_DELTA_MSB_ADDR	543
#define Q51001211009AK08_DBG_17_DELTA_LSB_ADDR	544
#define Q51001211009AK08_DBG_17_DELTA_MSB_ADDR	545
#define Q51001211009AK08_DBG_18_DELTA_LSB_ADDR	546
#define Q51001211009AK08_DBG_18_DELTA_MSB_ADDR	547
#define Q51001211009AK08_DBG_19_DELTA_LSB_ADDR	548
#define Q51001211009AK08_DBG_19_DELTA_MSB_ADDR	549
#define Q51001211009AK08_DBG_20_DELTA_LSB_ADDR	550
#define Q51001211009AK08_DBG_20_DELTA_MSB_ADDR	551
#define Q51001211009AK08_DBG_21_DELTA_LSB_ADDR	552
#define Q51001211009AK08_DBG_21_DELTA_MSB_ADDR	553
#define Q51001211009AK08_DBG_22_DELTA_LSB_ADDR	554
#define Q51001211009AK08_DBG_22_DELTA_MSB_ADDR	555
#define Q51001211009AK08_DBG_23_DELTA_LSB_ADDR	556
#define Q51001211009AK08_DBG_23_DELTA_MSB_ADDR	557
#define Q51001211009AK08_DBG_24_DELTA_LSB_ADDR	558
#define Q51001211009AK08_DBG_24_DELTA_MSB_ADDR	559
#define Q51001211009AK08_DBG_25_DELTA_LSB_ADDR	560
#define Q51001211009AK08_DBG_25_DELTA_MSB_ADDR	561
#define Q51001211009AK08_DBG_26_DELTA_LSB_ADDR	562
#define Q51001211009AK08_DBG_26_DELTA_MSB_ADDR	563
#define Q51001211009AK08_DBG_27_DELTA_LSB_ADDR	564
#define Q51001211009AK08_DBG_27_DELTA_MSB_ADDR	565
#define Q51001211009AK08_DBG_28_DELTA_LSB_ADDR	566
#define Q51001211009AK08_DBG_28_DELTA_MSB_ADDR	567
#define Q51001211009AK08_DBG_29_DELTA_LSB_ADDR	568
#define Q51001211009AK08_DBG_29_DELTA_MSB_ADDR	569
#define Q51001211009AK08_DBG_30_DELTA_LSB_ADDR	570
#define Q51001211009AK08_DBG_30_DELTA_MSB_ADDR	571
#define Q51001211009AK08_DBG_31_DELTA_LSB_ADDR	572
#define Q51001211009AK08_DBG_31_DELTA_MSB_ADDR	573
#define Q51001211009AK08_DBG_32_DELTA_LSB_ADDR	574
#define Q51001211009AK08_DBG_32_DELTA_MSB_ADDR	575
#define Q51001211009AK08_DBG_33_DELTA_LSB_ADDR	576
#define Q51001211009AK08_DBG_33_DELTA_MSB_ADDR	577
#define Q51001211009AK08_DBG_34_DELTA_LSB_ADDR	578
#define Q51001211009AK08_DBG_34_DELTA_MSB_ADDR	579
#define Q51001211009AK08_DBG_35_DELTA_LSB_ADDR	580
#define Q51001211009AK08_DBG_35_DELTA_MSB_ADDR	581
#define Q51001211009AK08_DBG_36_DELTA_LSB_ADDR	582
#define Q51001211009AK08_DBG_36_DELTA_MSB_ADDR	583
#define Q51001211009AK08_DBG_37_DELTA_LSB_ADDR	584
#define Q51001211009AK08_DBG_37_DELTA_MSB_ADDR	585
#define Q51001211009AK08_DBG_38_DELTA_LSB_ADDR	586
#define Q51001211009AK08_DBG_38_DELTA_MSB_ADDR	587
#define Q51001211009AK08_DBG_39_DELTA_LSB_ADDR	588
#define Q51001211009AK08_DBG_39_DELTA_MSB_ADDR	589
#define Q51001211009AK08_DBG_40_DELTA_LSB_ADDR	590
#define Q51001211009AK08_DBG_40_DELTA_MSB_ADDR	591
#define Q51001211009AK08_DBG_41_DELTA_LSB_ADDR	592
#define Q51001211009AK08_DBG_41_DELTA_MSB_ADDR	593
#define Q51001211009AK08_DBG_42_DELTA_LSB_ADDR	594
#define Q51001211009AK08_DBG_42_DELTA_MSB_ADDR	595
#define Q51001211009AK08_DBG_43_DELTA_LSB_ADDR	596
#define Q51001211009AK08_DBG_43_DELTA_MSB_ADDR	597
#define Q51001211009AK08_DBG_44_DELTA_LSB_ADDR	598
#define Q51001211009AK08_DBG_44_DELTA_MSB_ADDR	599
#define Q51001211009AK08_DBG_45_DELTA_LSB_ADDR	600
#define Q51001211009AK08_DBG_45_DELTA_MSB_ADDR	601
#define Q51001211009AK08_DBG_46_DELTA_LSB_ADDR	602
#define Q51001211009AK08_DBG_46_DELTA_MSB_ADDR	603
#define Q51001211009AK08_DBG_47_DELTA_LSB_ADDR	604
#define Q51001211009AK08_DBG_47_DELTA_MSB_ADDR	605
#define Q51001211009AK08_DBG_48_DELTA_LSB_ADDR	606
#define Q51001211009AK08_DBG_48_DELTA_MSB_ADDR	607
#define Q51001211009AK08_DBG_1_REF_LSB_ADDR	608
#define Q51001211009AK08_DBG_1_REF_MSB_ADDR	609
#define Q51001211009AK08_DBG_2_REF_LSB_ADDR	610
#define Q51001211009AK08_DBG_2_REF_MSB_ADDR	611
#define Q51001211009AK08_DBG_3_REF_LSB_ADDR	612
#define Q51001211009AK08_DBG_3_REF_MSB_ADDR	613
#define Q51001211009AK08_DBG_4_REF_LSB_ADDR	614
#define Q51001211009AK08_DBG_4_REF_MSB_ADDR	615
#define Q51001211009AK08_DBG_5_REF_LSB_ADDR	616
#define Q51001211009AK08_DBG_5_REF_MSB_ADDR	617
#define Q51001211009AK08_DBG_6_REF_LSB_ADDR	618
#define Q51001211009AK08_DBG_6_REF_MSB_ADDR	619
#define Q51001211009AK08_DBG_7_REF_LSB_ADDR	620
#define Q51001211009AK08_DBG_7_REF_MSB_ADDR	621
#define Q51001211009AK08_DBG_8_REF_LSB_ADDR	622
#define Q51001211009AK08_DBG_8_REF_MSB_ADDR	623
#define Q51001211009AK08_DBG_9_REF_LSB_ADDR	624
#define Q51001211009AK08_DBG_9_REF_MSB_ADDR	625
#define Q51001211009AK08_DBG_10_REF_LSB_ADDR	626
#define Q51001211009AK08_DBG_10_REF_MSB_ADDR	627
#define Q51001211009AK08_DBG_11_REF_LSB_ADDR	628
#define Q51001211009AK08_DBG_11_REF_MSB_ADDR	629
#define Q51001211009AK08_DBG_12_REF_LSB_ADDR	630
#define Q51001211009AK08_DBG_12_REF_MSB_ADDR	631
#define Q51001211009AK08_DBG_13_REF_LSB_ADDR	632
#define Q51001211009AK08_DBG_13_REF_MSB_ADDR	633
#define Q51001211009AK08_DBG_14_REF_LSB_ADDR	634
#define Q51001211009AK08_DBG_14_REF_MSB_ADDR	635
#define Q51001211009AK08_DBG_15_REF_LSB_ADDR	636
#define Q51001211009AK08_DBG_15_REF_MSB_ADDR	637
#define Q51001211009AK08_DBG_16_REF_LSB_ADDR	638
#define Q51001211009AK08_DBG_16_REF_MSB_ADDR	639
#define Q51001211009AK08_DBG_17_REF_LSB_ADDR	640
#define Q51001211009AK08_DBG_17_REF_MSB_ADDR	641
#define Q51001211009AK08_DBG_18_REF_LSB_ADDR	642
#define Q51001211009AK08_DBG_18_REF_MSB_ADDR	643
#define Q51001211009AK08_DBG_19_REF_LSB_ADDR	644
#define Q51001211009AK08_DBG_19_REF_MSB_ADDR	645
#define Q51001211009AK08_DBG_20_REF_LSB_ADDR	646
#define Q51001211009AK08_DBG_20_REF_MSB_ADDR	647
#define Q51001211009AK08_DBG_21_REF_LSB_ADDR	648
#define Q51001211009AK08_DBG_21_REF_MSB_ADDR	649
#define Q51001211009AK08_DBG_22_REF_LSB_ADDR	650
#define Q51001211009AK08_DBG_22_REF_MSB_ADDR	651
#define Q51001211009AK08_DBG_23_REF_LSB_ADDR	652
#define Q51001211009AK08_DBG_23_REF_MSB_ADDR	653
#define Q51001211009AK08_DBG_24_REF_LSB_ADDR	654
#define Q51001211009AK08_DBG_24_REF_MSB_ADDR	655
#define Q51001211009AK08_DBG_25_REF_LSB_ADDR	656
#define Q51001211009AK08_DBG_25_REF_MSB_ADDR	657
#define Q51001211009AK08_DBG_26_REF_LSB_ADDR	658
#define Q51001211009AK08_DBG_26_REF_MSB_ADDR	659
#define Q51001211009AK08_DBG_27_REF_LSB_ADDR	660
#define Q51001211009AK08_DBG_27_REF_MSB_ADDR	661
#define Q51001211009AK08_DBG_28_REF_LSB_ADDR	662
#define Q51001211009AK08_DBG_28_REF_MSB_ADDR	663
#define Q51001211009AK08_DBG_29_REF_LSB_ADDR	664
#define Q51001211009AK08_DBG_29_REF_MSB_ADDR	665
#define Q51001211009AK08_DBG_30_REF_LSB_ADDR	666
#define Q51001211009AK08_DBG_30_REF_MSB_ADDR	667
#define Q51001211009AK08_DBG_31_REF_LSB_ADDR	668
#define Q51001211009AK08_DBG_31_REF_MSB_ADDR	669
#define Q51001211009AK08_DBG_32_REF_LSB_ADDR	660
#define Q51001211009AK08_DBG_32_REF_MSB_ADDR	671
#define Q51001211009AK08_DBG_33_REF_LSB_ADDR	672
#define Q51001211009AK08_DBG_33_REF_MSB_ADDR	673
#define Q51001211009AK08_DBG_34_REF_LSB_ADDR	674
#define Q51001211009AK08_DBG_34_REF_MSB_ADDR	675
#define Q51001211009AK08_DBG_35_REF_LSB_ADDR	676
#define Q51001211009AK08_DBG_35_REF_MSB_ADDR	677
#define Q51001211009AK08_DBG_36_REF_LSB_ADDR	678
#define Q51001211009AK08_DBG_36_REF_MSB_ADDR	679
#define Q51001211009AK08_DBG_37_REF_LSB_ADDR	680
#define Q51001211009AK08_DBG_37_REF_MSB_ADDR	681
#define Q51001211009AK08_DBG_38_REF_LSB_ADDR	682
#define Q51001211009AK08_DBG_38_REF_MSB_ADDR	683
#define Q51001211009AK08_DBG_39_REF_LSB_ADDR	684
#define Q51001211009AK08_DBG_39_REF_MSB_ADDR	685
#define Q51001211009AK08_DBG_40_REF_LSB_ADDR	686
#define Q51001211009AK08_DBG_40_REF_MSB_ADDR	687
#define Q51001211009AK08_DBG_41_REF_LSB_ADDR	688
#define Q51001211009AK08_DBG_41_REF_MSB_ADDR	689
#define Q51001211009AK08_DBG_42_REF_LSB_ADDR	690
#define Q51001211009AK08_DBG_42_REF_MSB_ADDR	691
#define Q51001211009AK08_DBG_43_REF_LSB_ADDR	692
#define Q51001211009AK08_DBG_43_REF_MSB_ADDR	693
#define Q51001211009AK08_DBG_44_REF_LSB_ADDR	694
#define Q51001211009AK08_DBG_44_REF_MSB_ADDR	695
#define Q51001211009AK08_DBG_45_REF_LSB_ADDR	696
#define Q51001211009AK08_DBG_45_REF_MSB_ADDR	697
#define Q51001211009AK08_DBG_46_REF_LSB_ADDR	698
#define Q51001211009AK08_DBG_46_REF_MSB_ADDR	699
#define Q51001211009AK08_DBG_47_REF_LSB_ADDR	700
#define Q51001211009AK08_DBG_47_REF_MSB_ADDR	701
#define Q51001211009AK08_DBG_48_REF_LSB_ADDR	702
#define Q51001211009AK08_DBG_48_REF_MSB_ADDR	703

 
typedef struct
{
    uint16_t	      reg;
    uint8_t	      data;
} Q51001211009AK08_cfg;


#define TOUCH_PANEL_COLS                    3
#define TOUCH_PANEL_ROWS                    4

#define Q51001211009AK08_INVALID_REG             0
#define Q51001211009AK08_CHIP_ID                 0x20
#ifdef MOT_FEATURE_KEY08_SPECIFIC
#define Q_K03_CHIP_ID                       0x21
#endif /* MOT_FEATURE_KEY08_SPECIFIC */
#define Q51001211009AK08_I2C_RETRIES             10
#define Q51001211009AK08_READ_MSG_TIMEOUT        2000
#define Q51001211009AK08_EEPROM_PAGE             0
#define Q51001211009AK08_DEBUG_PAGE              1
#define Q51001211009AK08_UNSUPPORTED_REG         0xFFFF
#define Q51001211009AK08_CHIP_ID_INVALID         0
#define Q51001211009AK08_FW_VER_INVALID          0
#define Q51001211009AK08_MODE_INIT               0xFC
#define Q51001211009AK08_MODE_DETECTING          0xFD
#define Q51001211009AK08_MODE_UNINITIALIZED      0xFE
#define Q51001211009AK08_MODE_READY              0xFF
/* Supported firmware versions. Two main variants; register and message based */
#define Q51001211009AK08_FIRMWARE_2D             0x2D /* 1st msg based ver */
#define Q51001211009AK08_FIRMWARE_MSG_BASED      Q51001211009AK08_FIRMWARE_2D
/* Register settings */
#ifndef MOT_FEATURE_KEY08_SPECIFIC
#define Q51001211009AK08_CALIBRATE               0x01
#endif /* MOT_FEATURE_KEY08_SPECIFIC */
#define Q51001211009AK08_SLIDER0_CFG             (Q51001211009AK08_MSG_ENABLE_BIT | \
                                            TOUCH_PANEL_ROWS)
#define Q51001211009AK08_SLIDER_DISABLED         0x00
#define Q51001211009AK08_AUX_MODE_2A             0x20
#define Q51001211009AK08_BURST_LEN               0x40

/* key down only 0; change line low 0; pulse mode 01; two pulses 00; 173HZ freq 11 */
#define Q51001211009AK08_HAPTIC_SETTINGS_V2      0x13
/* b6 change line low 0; b5&4 pulse mode 01 */
#define Q51001211009AK08_HAPTIC_SETTINGS_V4      0x50
/* b7 8MHZ 1; b6 change line low 0; b5&4 pulse mode 01; b3 1 spread spectrum on */
#define Q51001211009AK08_HAPTIC_SETTINGS_V5      0x98
/* 175 Hz for press and release */
#define Q51001211009AK08_HAPTIC_AUXDATA1_V4      0x33
/* 2 pulses on press, 0 on release */
#define Q51001211009AK08_HAPTIC_AUXDATA2_V4      0x20
/* only on and off for V9 */
#define Q51001211009AK08_HAPTIC_V9		 0x01

#define Q51001211009AK08_MIN_CYCLE_10MS          0x0A
#define Q51001211009AK08_MIN_CYCLE_20MS          0x14
#define Q51001211009AK08_MIN_CYCLE_32MS          0x20
#define Q51001211009AK08_MIN_CYCLE_48MS          0x30
#define Q51001211009AK08_KEY_CONTROL_TOUCH       0x00
#define Q51001211009AK08_KEY_FSC                 0x00
#define Q51001211009AK08_KEY_FSC_ENABLE_HAP      0x10
#define Q51001211009AK08_KEY_FSC_NEG_THRH        0x0A
#define Q51001211009AK08_KEY_FSC_BURST_LEN_V4    0x40
#define Q51001211009AK08_KEY_FSC_BURST_LEN       0x30
#define Q51001211009AK08_KEY_TCH_BURST_LEN_V4    0x40
#define Q51001211009AK08_KEY_TCH_BURST_LEN       0x34
#define Q51001211009AK08_KEY_PROX_NEG_THRH       0x0a
#define Q51001211009AK08_KEY_PROX_BURST_LEN      0x40
#define Q51001211009AK08_PAGE_EEPROM             0x00
#define Q51001211009AK08_PAGE_DEBUG              0x01
#define Q51001211009AK08_LP_MODE_253MS           0xFD

#define Q51001211009AK08_LP_MODE_POWER_SAVE      Q51001211009AK08_LP_MODE_253MS


#define Q51001211009AK08_BURST_LEN_DISABLE       0x00

//#define Q51001211009AK08_KEY_NEG_THRH_V4         0x0A
//#define Q51001211009AK08_KEY_NEG_THRH            0x14
#define Q51001211009AK08_KEY_NEG_THRH_V4         0x8
#define Q51001211009AK08_KEY_NEG_THRH            0x8

#define Q51001211009AK08_MIN_CYCLE_SLEEP         0x00
#define Q51001211009AK08_MIN_CYCLE_16MS          0x10
#define Q51001211009AK08_MIN_CYCLE_AWAKE         Q51001211009AK08_MIN_CYCLE_16MS
#define Q51001211009AK08_RESOLUTION_FULL         0xFF
#define Q51001211009AK08_LP_MODE_SLEEP           0x00
#define Q51001211009AK08_LP_MODE_32MS            0x20
#define Q51001211009AK08_LP_MODE_AWAKE           Q51001211009AK08_LP_MODE_32MS
#define Q51001211009AK08_AKS_GROUP_1             0x01
#define Q51001211009AK08_ENABLE_FORCE_TRIG       0x40
#define Q51001211009AK08_FSR_SENSITIVITY         0xAA
#define Q51001211009AK08_KEY_CONTROL_AKS1_FSR    (Q51001211009AK08_ENABLE_FORCE_TRIG | \
                                            Q51001211009AK08_AKS_GROUP_1)
#define Q51001211009AK08_KEY_CONTROL_NOT_PRESENT 0x00
#define Q51001211009AK08_MSG_ENABLE_BIT          0x10
#define Q51001211009AK08_GUARD_DISABLE           0x19
#define Q51001211009AK08_AUXDATA_DFLT            0x00
#define Q51001211009AK08_NDRIFT                  0xA0
#define Q51001211009AK08_PDRIFT                  0x05

#define Q51001211009AK08_NRD                     0x96

#define Q51001211009AK08_DHT                     0x14

#define Q51001211009AK08_SLDR_HYST               0x02
#define Q51001211009AK08_SLDR1_K03_HYST          0x40

//#define Q51001211009AK08_SLDR_HYST               0x20

#define Q51001211009AK08_POS_FILTER              0x00
#define Q51001211009AK08_AWAKE_TIMEOUT           0x32
#define Q51001211009AK08_NDIL                    0x04
#define Q51001211009AK08_SDIL                    0x02
/* Register masks */
#define Q51001211009AK08_GEN_STATUS_TSCR_DET     0x10
#define Q51001211009AK08_GEN_STATUS_RESET_DET    0x80


#define Q51001211009AK08_MSG_STATUS_RESET_DET    0x80
#define Q51001211009AK08_MSG_STATUS_CYCLE_DET    0x40
#define Q51001211009AK08_MSG_STATUS_MAX_SIG_DET  0x20
#define Q51001211009AK08_MSG_STATUS_IN_CALIB_DET 0x10


/* K03 constants */
#define Q5199225K03_CHIP_ID                 0x21
#define Q5199225K03_BL_I2C_ADDR             (0x25u << 1)
#define Q5199225K03_MODE_BL_PWR_ON          0x00
#define Q5199225K03_MODE_BL_WAITING_FRAME   0x01
#define Q5199225K03_MODE_BL_FRAME_CRC_CHCK  0x02
#define Q5199225K03_MODE_BL_FRAME_CRC_FAIL  0x03
#define Q5199225K03_MODE_BL_FRAME_CRC_PASS  0x04
#define Q5199225K03_MODE_BL_APP_CRC_FAIL    0x08
#define Q5199225K03_FW_FRAME_LEN_SIZE       0x02
#define Q5199225K03_FW_IMAGE_VER            0x61
#define Q5199225K03_FW_IMAGE_LEN            sizeof(Q5199225K03_fw_image)

/* Number of rows and columns physically present on the touch panel */
#define TOUCH_PANEL_COLS  3
#define TOUCH_PANEL_ROWS  4

#define Q51001211009AK08_KEY_MSG                     0x0
#define Q51001211009AK08_SLIDER_MSG                  0x1
#define Q51001211009AK08_OMEGA_MSG                   0x2
#define Q51001211009AK08_8BIT_TSP_MSG                0x3
#define Q51001211009AK08_10BIT_TSP_MSG               0x4
#define Q51001211009AK08_STATUS_MSG                  0x7
#define Q51001211009AK08_READ_MSG                    0x8


#define Q51001211009AK08_MSG_PTR10_DATA_XL_BYTE	    2
#define Q51001211009AK08_MSG_PTR10_DATA_XH_BYTE	    3
#define Q51001211009AK08_MSG_PTR10_DATA_YL_BYTE	    4
#define Q51001211009AK08_MSG_PTR10_DATA_YH_BYTE	    5
#define Q51001211009AK08_MSG_PTR10_DATA_XYH_MASK	 0x03
#define Q51001211009AK08_MSG_PTR10_DEVICE_INDEX	    0

#define Q51001211009AK08_MSG_TOUCH_FLAG_BYTE 	    1
#define Q51001211009AK08_MSG_TOUCH_FLAG_SHIFT	    0
#define Q51001211009AK08_MSG_CRUNCH_FLAG_BYTE	    1
#define Q51001211009AK08_MSG_CRUNCH_FLAG_SHIFT	    4

/*
#define Q51001211009AK08_TS_MAX_X 			 1024
#define Q51001211009AK08_TS_MAX_Y	    	         1024
*/
#define Q51001211009AK08_TS_MAX_X 			 1023
#define Q51001211009AK08_TS_MAX_Y	    	         1023

/*
#define KEY08_MAX_Y	    400
#define KEY08_MAX_X	    240
*/
#define KEY08_MAX_X			Q51001211009AK08_TS_MAX_X
#define KEY08_MAX_Y			Q51001211009AK08_TS_MAX_Y

#define	SCREEN_X	320
#define	SCREEN_Y	480

#define Q5199225K02_CHIP_ID_REG 	     0
#define Q5199225K02_CODE_VER_REG 	     1
#define Q5199225K02_BACKUP_REG 	     	     2
#define Q5199225K02_CALIBRATE_REG 	     3
#define Q5199225K02_RESET_REG 	             4
#define Q5199225K02_READ_ADDR_REG 	     5
#define Q5199225K02_AUX_OUTPUT_REG 	     6
#define Q5199225K02_FORCE_SNSR_VAL_REG    15
#define Q5199225K02_KEY_STATUS0_REG 	  16
#define Q5199225K02_KEY_STATUS1_REG 	  17
#define Q5199225K02_KEY_STATUS2_REG 	  18
#define Q5199225K02_GEN_STATUS_REG 	  20
#define Q5199225K02_XY_POS0_REG 	21
#define Q5199225K02_XY_POS1_REG 	22
#define Q5199225K02_XY_POS2_REG 	23
#define Q5199225K02_XY_POS3_REG 	25
#define Q5199225K02_XY_POS4_REG 	26
#define Q5199225K02_XY_POS5_REG 	27
#define Q5199225K02_KEY_CONTROL0_REG	  32
#define Q5199225K02_KEY_CONTROL1_REG	  33
#define Q5199225K02_KEY_CONTROL2_REG	  34
#define Q5199225K02_KEY_CONTROL3_REG	  35
#define Q5199225K02_KEY_CONTROL4_REG	  36
#define Q5199225K02_KEY_CONTROL5_REG  37
#define Q5199225K02_KEY_CONTROL6_REG  38
#define Q5199225K02_KEY_CONTROL7_REG  39
#define Q5199225K02_KEY_CONTROL8_REG  40
#define Q5199225K02_KEY_CONTROL9_REG  41
#define Q5199225K02_KEY_CONTROL10_REG    42
#define Q5199225K02_KEY_CONTROL11_REG    43
#define Q5199225K02_KEY_CONTROL12_REG    44
#define Q5199225K02_KEY_CONTROL13_REG    45
#define Q5199225K02_KEY_CONTROL14_REG    46
#define Q5199225K02_KEY_CONTROL15_REG    47
#define Q5199225K02_KEY_CONTROL16_REG    48
#define Q5199225K02_KEY_CONTROL17_REG    49
#define Q5199225K02_KEY_CONTROL18_REG    50
#define Q5199225K02_KEY_CONTROL19_REG    51
#define Q5199225K02_KEY_CONTROL20_REG    52
#define Q5199225K02_KEY_CONTROL21_REG    53
#define Q5199225K02_KEY_CONTROL22_REG    54
#define Q5199225K02_KEY_CONTROL23_REG    55
#define Q5199225K02_KEY_NEG_THRH0_REG    64
#define Q5199225K02_KEY_NEG_THRH1_REG    65
#define Q5199225K02_KEY_NEG_THRH2_REG    66
#define Q5199225K02_KEY_NEG_THRH3_REG    67
#define Q5199225K02_KEY_NEG_THRH4_REG    68
#define Q5199225K02_KEY_NEG_THRH5_REG    69
#define Q5199225K02_KEY_NEG_THRH6_REG    70
#define Q5199225K02_KEY_NEG_THRH7_REG    71
#define Q5199225K02_KEY_NEG_THRH8_REG    72
#define Q5199225K02_KEY_NEG_THRH9_REG    73
#define Q5199225K02_KEY_NEG_THRH10_REG   74
#define Q5199225K02_KEY_NEG_THRH11_REG   75
#define Q5199225K02_KEY_NEG_THRH12_REG   76
#define Q5199225K02_KEY_NEG_THRH13_REG   77
#define Q5199225K02_KEY_NEG_THRH14_REG   78
#define Q5199225K02_KEY_NEG_THRH15_REG   79
#define Q5199225K02_KEY_NEG_THRH16_REG   80
#define Q5199225K02_KEY_NEG_THRH17_REG   81
#define Q5199225K02_KEY_NEG_THRH18_REG   82
#define Q5199225K02_KEY_NEG_THRH19_REG   83
#define Q5199225K02_KEY_NEG_THRH20_REG   84
#define Q5199225K02_KEY_NEG_THRH21_REG   85
#define Q5199225K02_KEY_NEG_THRH22_REG   86
#define Q5199225K02_KEY_NEG_THRH23_REG   87
#define Q5199225K02_BURST_LEN0_REG  	 96
#define Q5199225K02_BURST_LEN1_REG  	 97
#define Q5199225K02_BURST_LEN2_REG  	 98
#define Q5199225K02_BURST_LEN3_REG  	 99
#define Q5199225K02_BURST_LEN4_REG  	 100
#define Q5199225K02_BURST_LEN5_REG  	 101
#define Q5199225K02_BURST_LEN6_REG  	 102
#define Q5199225K02_BURST_LEN7_REG  	 103
#define Q5199225K02_BURST_LEN8_REG  	 104
#define Q5199225K02_BURST_LEN9_REG  	 105
#define Q5199225K02_BURST_LEN10_REG	 106
#define Q5199225K02_BURST_LEN11_REG	 107
#define Q5199225K02_BURST_LEN12_REG	 108
#define Q5199225K02_BURST_LEN13_REG	 109
#define Q5199225K02_BURST_LEN14_REG	 110
#define Q5199225K02_BURST_LEN15_REG	 111
#define Q5199225K02_BURST_LEN16_REG	 112
#define Q5199225K02_BURST_LEN17_REG	 113
#define Q5199225K02_BURST_LEN18_REG	 114
#define Q5199225K02_BURST_LEN19_REG	 115
#define Q5199225K02_BURST_LEN20_REG	 116
#define Q5199225K02_BURST_LEN21_REG	 117
#define Q5199225K02_BURST_LEN22_REG	 118
#define Q5199225K02_BURST_LEN23_REG	 119
#define Q5199225K02_MIN_CYCLE_REG 	     128
#define Q5199225K02_RESOLUTION0_REG 	  129
#define Q5199225K02_RESOLUTION1_REG 	  130
#define Q5199225K02_RESOLUTION2_REG 	  131
#define Q5199225K02_RESOLUTION3_REG 	  132
#define Q5199225K02_TRIG_ENABLE_REG 	  133
#define Q5199225K02_SLIDER0_REG 	   134
#define Q5199225K02_SLIDER1_REG 	   135
#define Q5199225K02_SLIDER2_REG 	   136
#define Q5199225K02_SLIDER3_REG 	   137
#define Q5199225K02_TS_ENABLE_REG   	 138
#define Q5199225K02_SLDR0_HYST_REG  	 139
#define Q5199225K02_SLDR1_HYST_REG  	 140
#define Q5199225K02_SLDR2_HYST_REG  	 141
#define Q5199225K02_SLDR3_HYST_REG  	 142
#define Q5199225K02_LP_MODE_REG 	   143
#define Q5199225K02_AUXDATA1_REG	   144
#define Q5199225K02_AUXDATA2_REG	   145
#define Q5199225K02_AUXDATA3_REG	   146
#define Q5199225K02_POS_FILTER_REG 	   147
#define Q5199225K02_AWAKE_TIMEOUT_REG	  148
#define Q5199225K02_GUARD_ENABLE_REG 	  149
#define Q5199225K02_AUX_SETUP_V4_REG       150
#define Q5199225K02_AUX_SETUP_REG 	     150
#define Q5199225K02_NDIL_REG 		  151
#define Q5199225K02_SDIL_REG 		  152
#define Q5199225K02_FORCE_THRH_REG 	     153
#define Q5199225K02_NDRIFT_REG  	   154
#define Q5199225K02_PDRIFT_REG  	   155
#define Q5199225K02_NRD_REG 		  156
#define Q5199225K02_DHT_REG 		  157
#define Q5199225K02_LIN_COEFF_OFF_X_LSB    158
#define Q5199225K02_LIN_COEFF_OFF_X_MSB    159
#define Q5199225K02_LIN_COEFF_X_SEG0 	  160
#define Q5199225K02_LIN_COEFF_X_SEG1 	  161
#define Q5199225K02_LIN_COEFF_X_SEG2 	  162
#define Q5199225K02_LIN_COEFF_X_SEG3 	  163
#define Q5199225K02_LIN_COEFF_X_SEG4 	  164
#define Q5199225K02_LIN_COEFF_X_SEG5 	  165
#define Q5199225K02_LIN_COEFF_X_SEG6 	  166
#define Q5199225K02_LIN_COEFF_X_SEG7 	  167
#define Q5199225K02_LIN_COEFF_X_SEG8 	  168
#define Q5199225K02_LIN_COEFF_X_SEG9 	  169
#define Q5199225K02_LIN_COEFF_X_SEG10	  170
#define Q5199225K02_LIN_COEFF_X_SEG11	  171
#define Q5199225K02_LIN_COEFF_X_SEG12	  172
#define Q5199225K02_LIN_COEFF_X_SEG13	  173
#define Q5199225K02_LIN_COEFF_X_SEG14	  174
#define Q5199225K02_LIN_COEFF_X_SEG15	  175
#define Q5199225K02_LIN_COEFF_OFF_Y_LSB    176
#define Q5199225K02_LIN_COEFF_OFF_Y_MSB    177
#define Q5199225K02_LIN_COEFF_Y_SEG0 	 178
#define Q5199225K02_LIN_COEFF_Y_SEG1 	 179
#define Q5199225K02_LIN_COEFF_Y_SEG2 	 180
#define Q5199225K02_LIN_COEFF_Y_SEG3 	 181
#define Q5199225K02_LIN_COEFF_Y_SEG4 	 182
#define Q5199225K02_LIN_COEFF_Y_SEG5 	 183
#define Q5199225K02_LIN_COEFF_Y_SEG6 	 184
#define Q5199225K02_LIN_COEFF_Y_SEG7 	 185
#define Q5199225K02_LIN_COEFF_Y_SEG8 	 186
#define Q5199225K02_LIN_COEFF_Y_SEG9 	 187
#define Q5199225K02_LIN_COEFF_Y_SEG10	 188
#define Q5199225K02_LIN_COEFF_Y_SEG11	 189
#define Q5199225K02_LIN_COEFF_Y_SEG12	 190
#define Q5199225K02_LIN_COEFF_Y_SEG13	 191
#define Q5199225K02_LIN_COEFF_Y_SEG14	 192
#define Q5199225K02_LIN_COEFF_Y_SEG15	 193
#define Q5199225K02_KEY0_SIG_LSB   	512
#define Q5199225K02_KEY0_SIG_MSB   	513
#define Q5199225K02_KEY1_SIG_LSB   	514
#define Q5199225K02_KEY1_SIG_MSB   	515
#define Q5199225K02_KEY2_SIG_LSB   	516
#define Q5199225K02_KEY2_SIG_MSB   	517
#define Q5199225K02_KEY3_SIG_LSB   	518
#define Q5199225K02_KEY3_SIG_MSB   	519
#define Q5199225K02_KEY4_SIG_LSB   	520
#define Q5199225K02_KEY4_SIG_MSB   	521
#define Q5199225K02_KEY5_SIG_LSB   	522
#define Q5199225K02_KEY5_SIG_MSB   	523
#define Q5199225K02_KEY6_SIG_LSB   	524
#define Q5199225K02_KEY6_SIG_MSB   	525
#define Q5199225K02_KEY7_SIG_LSB   	526
#define Q5199225K02_KEY7_SIG_MSB   	527
#define Q5199225K02_KEY8_SIG_LSB   	528
#define Q5199225K02_KEY8_SIG_MSB   	529
#define Q5199225K02_KEY9_SIG_LSB   	530
#define Q5199225K02_KEY9_SIG_MSB   	531
#define Q5199225K02_KEY10_SIG_LSB  	532
#define Q5199225K02_KEY10_SIG_MSB  	533
#define Q5199225K02_KEY11_SIG_LSB  	534
#define Q5199225K02_KEY11_SIG_MSB  	535
#define Q5199225K02_KEY12_SIG_LSB  	536
#define Q5199225K02_KEY12_SIG_MSB  	537
#define Q5199225K02_KEY13_SIG_LSB  	538
#define Q5199225K02_KEY13_SIG_MSB  	539
#define Q5199225K02_KEY14_SIG_LSB  	540
#define Q5199225K02_KEY14_SIG_MSB  	541
#define Q5199225K02_KEY15_SIG_LSB  	542
#define Q5199225K02_KEY15_SIG_MSB  	543
#define Q5199225K02_KEY16_SIG_LSB  	544
#define Q5199225K02_KEY16_SIG_MSB  	545
#define Q5199225K02_KEY17_SIG_LSB  	546
#define Q5199225K02_KEY17_SIG_MSB  	547
#define Q5199225K02_KEY18_SIG_LSB  	548
#define Q5199225K02_KEY18_SIG_MSB  	549
#define Q5199225K02_KEY19_SIG_LSB  	550
#define Q5199225K02_KEY19_SIG_MSB  	551
#define Q5199225K02_KEY20_SIG_LSB  	552
#define Q5199225K02_KEY20_SIG_MSB  	553
#define Q5199225K02_KEY21_SIG_LSB  	554
#define Q5199225K02_KEY21_SIG_MSB  	555
#define Q5199225K02_KEY22_SIG_LSB  	556
#define Q5199225K02_KEY22_SIG_MSB  	557
#define Q5199225K02_KEY23_SIG_LSB  	558
#define Q5199225K02_KEY23_SIG_MSB  	559
#define Q5199225K02_KEY0_REF_LSB   	560
#define Q5199225K02_KEY0_REF_MSB   	561
#define Q5199225K02_KEY1_REF_LSB   	562
#define Q5199225K02_KEY1_REF_MSB   	563
#define Q5199225K02_KEY2_REF_LSB   	564
#define Q5199225K02_KEY2_REF_MSB   	565
#define Q5199225K02_KEY3_REF_LSB   	566
#define Q5199225K02_KEY3_REF_MSB   	567
#define Q5199225K02_KEY4_REF_LSB   	568
#define Q5199225K02_KEY4_REF_MSB   	569
#define Q5199225K02_KEY5_REF_LSB   	570
#define Q5199225K02_KEY5_REF_MSB   	571
#define Q5199225K02_KEY6_REF_LSB   	572
#define Q5199225K02_KEY6_REF_MSB   	573
#define Q5199225K02_KEY7_REF_LSB   	574
#define Q5199225K02_KEY7_REF_MSB   	575
#define Q5199225K02_KEY8_REF_LSB   	576
#define Q5199225K02_KEY8_REF_MSB   	577
#define Q5199225K02_KEY9_REF_LSB   	578
#define Q5199225K02_KEY9_REF_MSB   	579
#define Q5199225K02_KEY10_REF_LSB  	580
#define Q5199225K02_KEY10_REF_MSB  	581
#define Q5199225K02_KEY11_REF_LSB  	582
#define Q5199225K02_KEY11_REF_MSB  	583
#define Q5199225K02_KEY12_REF_LSB  	584
#define Q5199225K02_KEY12_REF_MSB  	585
#define Q5199225K02_KEY13_REF_LSB  	586
#define Q5199225K02_KEY13_REF_MSB  	587
#define Q5199225K02_KEY14_REF_LSB  	588
#define Q5199225K02_KEY14_REF_MSB  	589
#define Q5199225K02_KEY15_REF_LSB  	590
#define Q5199225K02_KEY15_REF_MSB  	591
#define Q5199225K02_KEY16_REF_LSB  	592
#define Q5199225K02_KEY16_REF_MSB  	593
#define Q5199225K02_KEY17_REF_LSB  	594
#define Q5199225K02_KEY17_REF_MSB  	595
#define Q5199225K02_KEY18_REF_LSB  	596
#define Q5199225K02_KEY18_REF_MSB  	597
#define Q5199225K02_KEY19_REF_LSB  	598
#define Q5199225K02_KEY19_REF_MSB  	599
#define Q5199225K02_KEY20_REF_LSB  	600
#define Q5199225K02_KEY20_REF_MSB  	601
#define Q5199225K02_KEY21_REF_LSB  	602
#define Q5199225K02_KEY21_REF_MSB  	603
#define Q5199225K02_KEY22_REF_LSB  	604
#define Q5199225K02_KEY22_REF_MSB  	605
#define Q5199225K02_KEY23_REF_LSB  	606
#define Q5199225K02_KEY23_REF_MSB  	607
 
 
 
 
 
typedef struct
{
    uint16_t	      reg;
    uint8_t	      data;
} Q5199225K02_cfg;


#define TOUCH_PANEL_COLS                    3
#define TOUCH_PANEL_ROWS                    4

#define Q5199225K02_INVALID_REG             0
#define Q5199225K02_CHIP_ID                 0x20
#ifdef MOT_FEATURE_HALO_SPECIFIC
#define Q_K03_CHIP_ID                       0x21
#endif /* MOT_FEATURE_HALO_SPECIFIC */
#define Q5199225K02_I2C_RETRIES             10
#define Q5199225K02_READ_MSG_TIMEOUT        2000
#define Q5199225K02_EEPROM_PAGE             0
#define Q5199225K02_DEBUG_PAGE              1
#define Q5199225K02_UNSUPPORTED_REG         0xFFFF
#define Q5199225K02_CHIP_ID_INVALID         0
#define Q5199225K02_FW_VER_INVALID          0
#define Q5199225K02_MODE_INIT               0xFC
#define Q5199225K02_MODE_DETECTING          0xFD
#define Q5199225K02_MODE_UNINITIALIZED      0xFE
#define Q5199225K02_MODE_READY              0xFF
/* Supported firmware versions. Two main variants; register and message based */
#define Q5199225K02_FIRMWARE_2D             0x2D /* 1st msg based ver */
#define Q5199225K02_FIRMWARE_MSG_BASED      Q5199225K02_FIRMWARE_2D
/* Register settings */
#ifndef MOT_FEATURE_HALO_SPECIFIC
#define Q5199225K02_CALIBRATE               0x01
#endif /* MOT_FEATURE_HALO_SPECIFIC */
#define Q5199225K02_SLIDER0_CFG             (Q5199225K02_MSG_ENABLE_BIT | \
                                            TOUCH_PANEL_ROWS)
#define Q5199225K02_SLIDER_DISABLED         0x00
#define Q5199225K02_AUX_MODE_2A             0x20
#define Q5199225K02_BURST_LEN               0x40

/* key down only 0; change line low 0; pulse mode 01; two pulses 00; 173HZ freq 11 */
#define Q5199225K02_HAPTIC_SETTINGS_V2      0x13
/* b6 change line low 0; b5&4 pulse mode 01 */
//#define Q5199225K02_HAPTIC_SETTINGS_V4      0x50
#define Q5199225K02_HAPTIC_SETTINGS_V4      0x10
/* b7 8MHZ 1; b6 change line low 0; b5&4 pulse mode 01; b3 1 spread spectrum on */
#define Q5199225K02_HAPTIC_SETTINGS_V5      0x98
/* 175 Hz for press and release */
#define Q5199225K02_HAPTIC_AUXDATA1_V4      0x00
/* 2 pulses on press, 0 on release */
#define Q5199225K02_HAPTIC_AUXDATA2_V4      0x20
#define Q5199225K02_MIN_CYCLE_10MS          0x0A
#define Q5199225K02_MIN_CYCLE_20MS          0x14
#define Q5199225K02_MIN_CYCLE_32MS          0x20
#define Q5199225K02_MIN_CYCLE_48MS          0x30
#define Q5199225K02_KEY_CONTROL_TOUCH       0x00
#define Q5199225K02_KEY_FSC                 0x00
#define Q5199225K02_KEY_FSC_ENABLE_HAP      0x10
#define Q5199225K02_KEY_FSC_NEG_THRH        0x0A
#define Q5199225K02_KEY_FSC_BURST_LEN_V4    0x40
#define Q5199225K02_KEY_FSC_BURST_LEN       0x30
#define Q5199225K02_KEY_TCH_BURST_LEN_V4    0x20
#define Q5199225K02_KEY_TCH_BURST_LEN       0x34
#define Q5199225K02_KEY_PROX_NEG_THRH       0x0a
#define Q5199225K02_KEY_PROX_BURST_LEN      0x40
#define Q5199225K02_PAGE_EEPROM             0x00
#define Q5199225K02_PAGE_DEBUG              0x01
#define Q5199225K02_LP_MODE_253MS           0xFD

#define Q5199225K02_LP_MODE_POWER_SAVE      Q5199225K02_LP_MODE_253MS


#define Q5199225K02_BURST_LEN_DISABLE       0x00

//#define Q5199225K02_KEY_NEG_THRH_V4         0x0A
//#define Q5199225K02_KEY_NEG_THRH            0x14
#define Q5199225K02_KEY_NEG_THRH_V4         0xA
#define Q5199225K02_KEY_NEG_THRH            0xA

#define Q5199225K02_MIN_CYCLE_SLEEP         0x00
#define Q5199225K02_MIN_CYCLE_16MS          0x10
#define Q5199225K02_MIN_CYCLE_AWAKE         Q5199225K02_MIN_CYCLE_16MS
#define Q5199225K02_RESOLUTION_FULL         0xFF
#define Q5199225K02_LP_MODE_SLEEP           0x00
#define Q5199225K02_LP_MODE_32MS            0x20
#define Q5199225K02_LP_MODE_AWAKE           Q5199225K02_LP_MODE_32MS
#define Q5199225K02_AKS_GROUP_1             0x01
#define Q5199225K02_ENABLE_FORCE_TRIG       0x40
#define Q5199225K02_FSR_SENSITIVITY         0xAA
#define Q5199225K02_KEY_CONTROL_AKS1_FSR    (Q5199225K02_ENABLE_FORCE_TRIG | \
                                            Q5199225K02_AKS_GROUP_1)
#define Q5199225K02_KEY_CONTROL_NOT_PRESENT 0x00
#define Q5199225K02_MSG_ENABLE_BIT          0x10
#define Q5199225K02_GUARD_DISABLE           0x19
#define Q5199225K02_AUXDATA_DFLT            0x00
#define Q5199225K02_NDRIFT                  0xA0
#define Q5199225K02_PDRIFT                  0x05

#define Q5199225K02_NRD                     0x96

#define Q5199225K02_DHT                     0x14

#define Q5199225K02_SLDR_HYST               0x02
#define Q5199225K02_SLDR1_K03_HYST          0x40

//#define Q5199225K02_SLDR_HYST               0x20

#define Q5199225K02_POS_FILTER              0x00
#define Q5199225K02_AWAKE_TIMEOUT           0x32
#define Q5199225K02_NDIL                    0x04
#define Q5199225K02_SDIL                    0x02
/* Register masks */
#define Q5199225K02_GEN_STATUS_TSCR_DET     0x10
#define Q5199225K02_GEN_STATUS_RESET_DET    0x80


#define Q5199225K02_MSG_STATUS_RESET_DET    0x80
#define Q5199225K02_MSG_STATUS_CYCLE_DET    0x40
#define Q5199225K02_MSG_STATUS_MAX_SIG_DET  0x20
#define Q5199225K02_MSG_STATUS_IN_CALIB_DET 0x10


/* K03 constants */
#define Q5199225K03_CHIP_ID                 0x21
#define Q5199225K03_BL_I2C_ADDR             (0x25u << 1)
#define Q5199225K03_MODE_BL_PWR_ON          0x00
#define Q5199225K03_MODE_BL_WAITING_FRAME   0x01
#define Q5199225K03_MODE_BL_FRAME_CRC_CHCK  0x02
#define Q5199225K03_MODE_BL_FRAME_CRC_FAIL  0x03
#define Q5199225K03_MODE_BL_FRAME_CRC_PASS  0x04
#define Q5199225K03_MODE_BL_APP_CRC_FAIL    0x08
#define Q5199225K03_FW_FRAME_LEN_SIZE       0x02
#define Q5199225K03_FW_IMAGE_VER            0x61
#define Q5199225K03_FW_IMAGE_LEN            sizeof(Q5199225K03_fw_image)

/* Number of rows and columns physically present on the touch panel */
#define TOUCH_PANEL_COLS  3
#define TOUCH_PANEL_ROWS  4

#define Q5199225K02_KEY_MSG                     0x0
#define Q5199225K02_SLIDER_MSG                  0x1
#define Q5199225K02_OMEGA_MSG                   0x2
#define Q5199225K02_8BIT_TSP_MSG                0x3
#define Q5199225K02_10BIT_TSP_MSG               0x4
#define Q5199225K02_STATUS_MSG                  0x7
#define Q5199225K02_READ_MSG                    0x8


#define Q5199225K02_MSG_PTR10_DATA_XL_BYTE	    2
#define Q5199225K02_MSG_PTR10_DATA_XH_BYTE	    3
#define Q5199225K02_MSG_PTR10_DATA_YL_BYTE	    4
#define Q5199225K02_MSG_PTR10_DATA_YH_BYTE	    5
#define Q5199225K02_MSG_PTR10_DATA_XYH_MASK	 0x03
#define Q5199225K02_MSG_PTR10_DEVICE_INDEX	    0

#define Q5199225K02_MSG_TOUCH_FLAG_BYTE 	    0
#define Q5199225K02_MSG_TOUCH_FLAG_SHIFT	    0
#define Q5199225K02_MSG_CRUNCH_FLAG_BYTE	    1
#define Q5199225K02_MSG_CRUNCH_FLAG_SHIFT	    4

#define Q5199225K02_TS_MAX_X 			 1024
#define Q5199225K02_TS_MAX_Y	    	         1024

